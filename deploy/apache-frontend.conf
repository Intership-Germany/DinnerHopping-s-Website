# VirtualHost pour le frontend statique (www.example.com)
<VirtualHost *:80>
    ServerName www.example.com
    ServerAlias example.com
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^/(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]
</VirtualHost>

<VirtualHost *:443>
    ServerName www.example.com
    ServerAlias example.com

    DocumentRoot /var/www/dinnerhopping
    SSLEngine On
    SSLCertificateFile /etc/letsencrypt/live/www.example.com/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/www.example.com/privkey.pem
    Include /etc/letsencrypt/options-ssl-apache.conf

    <Directory /var/www/dinnerhopping>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        # Cache basique pour assets
        <FilesMatch "\.(js|css|png|jpg|jpeg|gif|svg|woff2?)$">
            Header set Cache-Control "public, max-age=31536000, immutable"
        </FilesMatch>
        <FilesMatch "\.(html)$">
            Header set Cache-Control "no-cache"
        </FilesMatch>
    </Directory>

    # CORS pour tester (si besoin, sinon gérer côté API uniquement)
    # Header always set Access-Control-Allow-Origin "https://www.example.com"

    ErrorLog  /var/log/apache2/front_error.log
    CustomLog /var/log/apache2/front_access.log combined
</VirtualHost>
