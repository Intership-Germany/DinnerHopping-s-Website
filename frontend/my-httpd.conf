# Custom Apache configuration for DinnerHopping frontend inside the Docker image.
# The container is typically served behind a reverse proxy, so keep the vhost flexible.

<VirtualHost *:80>
    ServerName localhost
    ServerAlias dinnerhoppings.acrevon.fr www.dinnerhoppings.acrevon.fr
    UseCanonicalName Off

    DocumentRoot "/usr/local/apache2/htdocs"

    <Directory "/usr/local/apache2/htdocs">
        AllowOverride All
        Require all granted
        # Enable content negotiation so URLs without extensions can map to files
        # e.g. /home -> /home.html when the file exists.
        Options FollowSymLinks MultiViews
    </Directory>

    ErrorLog "/usr/local/apache2/logs/frontend_error.log"
    CustomLog "/usr/local/apache2/logs/frontend_access.log" combined

    # Keep redirects host-agnostic to avoid forcing a specific hostname for remote visitors
    <IfModule mod_rewrite.c>
        RewriteEngine On

        # If a request has no extension and a matching .html file exists, serve it
        # internally (no redirect). This helps support both /home.html and /home.
        # First, check for exact index.html redirect
        RewriteCond %{REQUEST_URI} ^/index\.html$
        RewriteRule ^.*$ / [R=302,L]

        # Fallback rewrite: when the requested path doesn't contain a dot (no
        # extension) and the corresponding .html file exists, rewrite to it.
        RewriteCond %{REQUEST_URI} !\.[^/]+$
        RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI}.html -f
        RewriteRule ^(.*?)/?$ $1.html [L]
    </IfModule>
</VirtualHost>
